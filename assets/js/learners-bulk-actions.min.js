jQuery(document).ready(function(){var e=jQuery.noConflict(),n=(sensei_learners_bulk_data,function(n,t){var r=[];return e.each(n,function(e,n){r.push(t(n))}),r}),t=function(n,t){var r=[];return e.each(n,function(e,n){t(n)&&r.push(n)}),r},r=function(){var e=[],r=[],s="";return{updateSelectedUserIdsFromCheckbox:function(n){var t=parseInt(n.val(),10),r=e.indexOf(t);return n.is(":checked")?r<0&&e.push(t):r>-1&&e.splice(r,1),console.log(e),this},getUserIds:function(){return e},setAction:function(e){s=e},setCourseIds:function(e){return r=n(e,function(e){return parseInt(e,10)}),this},resetSelectedUserIds:function(){return e=[],r=[],s="",this},validate:function(){return 0===e.length?{isValid:!1,reason:"Select some learners"}:0===t(r,function(e){return!isNaN(e)}).length?{isValid:!1,reason:"Select a course"}:""==s?{isValid:!1,reason:"Select an action"}:{isValid:!0,reason:""}}}}();!function(n){var t=e("#bulk-action-user-ids"),r=e("#bulk-action-course-ids"),s=e("#bulk-learner-action-submit"),o=e("#bulk-learner-actions-form"),i=e("#bulk-action-selector-top"),c=e("#sensei-bulk-action"),a=e(".sensei-course-select"),l=e("#bulk-action-course-select"),u=e(".sensei_user_select_id"),d=e("#cb-select-all-1"),v=e(".learner-course-overview-detail"),f=e(".learner-course-overview-detail-btn"),h=e("#cb-select-all-2"),k=function(t,r){t.on("click",function(s){n.resetSelectedUserIds(),t.is(":checked")?(r.attr("checked","checked"),u.attr("checked","checked"),u.each(function(t,r){n.updateSelectedUserIdsFromCheckbox(e(r))})):(u.removeAttr("checked"),r.removeAttr("checked"))})};a.select2({placeholder:sensei_learners_bulk_data.select_course_placeholder,width:"300px"}),u.on("change",function(t){var r=e(this);t.preventDefault(),t.stopPropagation(),n.updateSelectedUserIdsFromCheckbox(r)}),k(d,h),k(h,d);var p=e("#sensei-bulk-learner-actions-modal");e("#sensei-bulk-learner-actions-modal-toggle").on("click",function(e){return p.modal({fadeDuration:100,fadeDelay:.5}),!1});f.on("click",function(n){n.preventDefault(),n.stopPropagation();var t=e(this),r=t.siblings(".learner-course-overview-detail").first();v.filter(":visible").slideUp("slow"),r.is(":hidden")?r.slideDown("slow"):r.slideUp("slow")}),i.on("change",function(e){c.val(i.val().trim())}),s.on("click",function(e){e.preventDefault(),e.stopPropagation(),n.setCourseIds(l.val()).setAction(c.val().trim());var s=n.validate();return s.isValid?(t.val(n.getUserIds().join(",")),r.val(l.val().join(",")),void o.submit()):void console.log(s)})}(r)});