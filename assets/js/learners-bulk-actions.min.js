"use strict";jQuery(document).ready(function(){var e=jQuery.noConflict(),t=(sensei_learners_bulk_data,function(t,r){var i=[];return e.each(t,function(e,t){i.push(r(t))}),i}),r=function(t,r){var i=[];return e.each(t,function(e,t){r(t)&&i.push(t)}),i},i=function(){var e=[],i=[],n="",a={isValid:!0,reason:""};return{updateSelectedUserIdsFromCheckbox:function(t){var r=parseInt(t.val(),10),i=e.indexOf(r);return t.is(":checked")?i<0&&e.push(r):i>-1&&e.splice(i,1),console.log(e),this},getUserIds:function(){return e},setAction:function(e){return n=e,this},setCourseIds:function(e){return i=t(e,function(e){return parseInt(e,10)}),this},resetSelectedUserIds:function(){return e=[],this},resetAll:function(){return this.resetSelectedUserIds(),i=[],n="",this},validator:function(){return{validateBulkAction:function(){return""==n?{isValid:!1,reason:"Select an action"}:a},validateCourseIds:function(){return 0===r(i,function(e){return!isNaN(e)}).length?{isValid:!1,reason:"Select a course"}:a},validateSelectedUserIds:function(){return 0===e.length?{isValid:!1,reason:"Select some learners"}:a},validate:function(){for(var e=[this.validateSelectedUserIds,this.validateBulkAction,this.validateCourseIds];e.length>0;)if(currentValidatorResult=e.shift().call(this),!currentValidatorResult.isValid)return currentValidatorResult;return a}}},validate:function(){return this.validator().validate()}}}();!function(t){var r=e("#bulk-action-user-ids"),i=e("#bulk-action-course-ids"),n=e("#bulk-learner-action-submit"),a=e("#bulk-learner-actions-form"),s=e("#bulk-action-selector-top"),l=e("#sensei-bulk-action"),o=e(".sensei-course-select"),c=e("#bulk-action-course-select"),d=e(".sensei_user_select_id"),u=e("#cb-select-all-1"),v=e(".learner-course-overview-detail"),f=e(".learner-course-overview-detail-btn"),h=e("#cb-select-all-2"),k=e("#sensei-bulk-learner-actions-modal-toggle"),b=e("#sensei-bulk-learner-actions-modal"),p=function(r,i){r.on("click",function(n){t.resetSelectedUserIds(),r.is(":checked")?(i.attr("checked","checked"),d.attr("checked","checked"),d.each(function(r,i){t.updateSelectedUserIdsFromCheckbox(e(i))})):(d.removeAttr("checked"),i.removeAttr("checked")),I()})},I=function(){var e=t.validator(),r=e.validateBulkAction(),i=e.validateSelectedUserIds();r.isValid&&i.isValid?k.removeAttr("disabled"):k.attr("disabled",!0)};o.select2({placeholder:sensei_learners_bulk_data.select_course_placeholder,width:"300px"}),d.on("change",function(r){var i=e(this);r.preventDefault(),r.stopPropagation(),t.updateSelectedUserIdsFromCheckbox(i),I()}),p(u,h),p(h,u),k.attr("disabled",!0),k.on("click",function(e){return b.modal({fadeDuration:100,fadeDelay:.5}),!1}),f.on("click",function(t){t.preventDefault(),t.stopPropagation();var r=e(this),i=r.siblings(".learner-course-overview-detail").first();v.filter(":visible").slideUp("slow"),i.is(":hidden")?i.slideDown("slow"):i.slideUp("slow")}),s.on("change",function(e){l.val(s.val().trim()),t.setAction(l.val()),I()}),c.on("change",function(){var e=t.setCourseIds(c.val()).validator().validateCourseIds().isValid;e?n.removeAttr("disabled"):n.attr("disabled",!0)}),n.attr("disabled",!0),n.on("click",function(e){e.preventDefault(),e.stopPropagation(),t.setCourseIds(c.val()).setAction(l.val().trim());var n=t.validate();return n.isValid?(r.val(t.getUserIds().join(",")),i.val(c.val().join(",")),void a.submit()):void console.log(n)})}(i)});