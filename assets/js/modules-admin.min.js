"use strict";function getParameterByName(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var s=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(location.search);return null===s?"":decodeURIComponent(s[1].replace(/\+/g," "))}jQuery(document).ready(function(){var l=window._;jQuery("#module-order-course").select2({width:"resolve"}),jQuery("select#lesson-module-options").select2({width:"resolve"}),jQuery(".sortable-module-list").sortable(),jQuery(".sortable-tab-list").disableSelection(),jQuery(".sortable-module-list").bind("sortstop",function(){var s="";jQuery(this).find(".module").each(function(e){(0<e&&(s+=","),s+=jQuery(this).find("span").attr("rel"),jQuery(this).removeClass("alternate"),jQuery(this).removeClass("first"),jQuery(this).removeClass("last"),0==e)?jQuery(this).addClass("first alternate"):0==e%2&&jQuery(this).addClass("alternate")}),jQuery('input[name="module-order"]').attr("value",s)}),jQuery("select.ajax_chosen_select_courses").select2({minimumInputLength:2,placeholder:window.modulesAdmin.selectplaceholder,width:"300px",multiple:!0,ajax:{url:ajaxurl,delay:250,dataType:"json",cache:!0,data:function(e){return{term:e.term,page:e.page||1,action:"sensei_json_search_courses",security:window.modulesAdmin.search_courses_nonce,default:""}},processResults:function(e,s){var r=[];return jQuery.each(e,function(e,s){if(!jQuery.isEmptyObject(s)){var t={id:e,text:s};r.push(t)}}),{results:r,page:s}}}}),jQuery("#sensei-module-add-toggle").on("click",function(){var e="wp-hidden-child",s=jQuery(this).parent().next("p#sensei-module-add"),t=s.children("#newmodule");if(s.hasClass(e))return s.removeClass(e),t.val(""),void t.focus();s.addClass(e)}),jQuery("#sensei-module-add-submit").on("click",function(){var e=getParameterByName("post"),a=jQuery(this).parent().children("#newmodule"),s=jQuery(this).parent().children("#add_module_nonce"),u=jQuery("#module_course_mb #taxonomy-module #module-all ul#modulechecklist"),t=a.val(),r=s.val();if(l.isEmpty(t)||l.isEmpty(r))a.focus();else{var o={newTerm:t,security:r,action:"sensei_add_new_module_term",course_id:e,from_page:"course"};jQuery.post(ajaxurl,o,function(e){var s,t;if(e.success){if(s=e.data.termId,t=e.data.termName,!(0<parseInt(s))||l.isEmpty(t))return void a.focus();var r='<li id="module-'+s+'">';return r+='<label class="selectit">',r+='<input value="'+s+'" type="checkbox" checked="checked" name="tax_input[module][]" id="in-module-'+s+'">',r+=t,r+="</label></li>",u.prepend(r),a.val(""),void a.focus()}if(void 0!==e.data.errors&&void 0!==e.data.errors.term_exists){s=e.data.term.id;var o=u.find("#module-"+s+" input");o.prop("checked","checked"),o.focus(),a.val("")}})}});var t=jQuery("#lesson-course-options"),r=jQuery("div#lesson-module-metabox-select");t.on("change",function(){if(window.modulesAdmin.getCourseModulesNonce){var e=t.val(),s={security:window.modulesAdmin.getCourseModulesNonce,action:"sensei_get_course_modules",course_id:e};s.course_id&&jQuery.post(ajaxurl,s,function(e){if(!0===e.success){var s=e.data.content;r.html(s),jQuery("select#lesson-module-options").select2({width:"resolve"})}})}})});