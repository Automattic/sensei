"use strict";jQuery(document).ready(function(){jQuery.fn.exists=function(){return this.length>0},jQuery.fn.calculateTotalGrade=function(){var e,r,t=0,n=0;jQuery(".question_box.user_right").each(function(){e=jQuery(this).find(".question_id").val(),r=parseInt(jQuery(this).find("#question_"+e+"_grade").val()),t+=r,n++}),jQuery(".question_box.user_wrong").each(function(){n++}),jQuery("#total_graded_questions").val(n);var a=parseInt(jQuery("#total_questions").val()),i=parseInt(jQuery("#quiz_grade_total").val()),s=0;0<i&&(s=parseFloat(100*t/i).toFixed(2)),s=s.replace(".00",""),jQuery("#total_grade").val(t),jQuery(".total_grade_total").html(t),jQuery(".total_grade_percent").html(s),jQuery(".quiz_grade_total").html(i),a==n?(jQuery("#all_questions_graded").val("yes"),jQuery(".grade-button").val("Grade")):(jQuery("#all_questions_graded").val("no"),jQuery(".grade-button").val("Save"))},jQuery.fn.autoGrade=function(){jQuery(".question_box").each(function(){if(jQuery(this).hasClass("user_right")||jQuery(this).hasClass("user_wrong")||jQuery(this).hasClass("zero-graded"))jQuery(this).hasClass("zero-graded")&&(jQuery(this).find(".grading-mark.icon_wrong input").attr("checked",!1),jQuery(this).find(".grading-mark.icon_right input").attr("checked",!1),jQuery(this).find(".input.question-grade").val(0));else{jQuery(this).addClass("ungraded");var e,r;jQuery(this).hasClass("gap-fill")?(e=jQuery(this).find(".user-answer .highlight").html(),r=jQuery(this).find(".correct-answer .highlight").html()):(e=jQuery(this).find(".user-answer").html(),r=jQuery(this).find(".correct-answer").html()),e==r?(jQuery(this).addClass("user_right").removeClass("user_wrong").removeClass("ungraded"),jQuery(this).find(".grading-mark.icon_right input").attr("checked",!0),jQuery(this).find(".grading-mark.icon_wrong input").attr("checked",!1),jQuery(this).find("input.question-grade").val(jQuery(this).find("input.question_total_grade").val())):jQuery(this).hasClass("auto-grade")?(jQuery(this).addClass("user_wrong").removeClass("user_right").removeClass("ungraded"),jQuery(this).find(".grading-mark.icon_wrong input").attr("checked",!0),jQuery(this).find(".grading-mark.icon_right input").attr("checked",!1),jQuery(this).find(".input.question-grade").val(0)):(jQuery(this).find(".grading-mark.icon_wrong input").attr("checked",!1),jQuery(this).find(".grading-mark.icon_right input").attr("checked",!1),jQuery(this).removeClass("user_wrong").removeClass("user_right"))}}),jQuery.fn.calculateTotalGrade()},jQuery.fn.resetGrades=function(){jQuery(".question_box").find(".grading-mark.icon_wrong input").attr("checked",!1),jQuery(".question_box").find(".grading-mark.icon_right input").attr("checked",!1),jQuery(".question_box").removeClass("user_wrong").removeClass("user_right").removeClass("ungraded"),jQuery(".question-grade").val("0"),jQuery.fn.calculateTotalGrade()},jQuery.fn.getQueryVariable=function(e){for(var r=window.location.search.substring(1),t=r.split("&"),n=0;n<t.length;n++){var a=t[n].split("=");if(a[0]==e)return a[1]}return!1},jQuery("#grading-course-options").on("change","",function(){var e=jQuery(this).val(),r="";return r+="course_id="+e,jQuery.post(ajaxurl,{action:"get_lessons_dropdown",get_lessons_dropdown_nonce:woo_localized_data.get_lessons_dropdown_nonce,data:r},function(e){""!=e&&(jQuery("#learners-to-grade").empty(),jQuery("#learners-graded").empty(),jQuery("#grading-lesson-options").empty().append(e),jQuery("#grading-lesson-options").exists()&&(jQuery("#grading-lesson-options-label").show(),jQuery("#grading-lesson-options").trigger("change")))}),!1}),jQuery("#grading-lesson-options").on("change","",function(){var e=jQuery(this).val(),r=jQuery("#grading-course-options").val(),t="";t+="lesson_id="+e,t+="&course_id="+r;var n=jQuery.fn.getQueryVariable("view");return t+=n?"&view="+n:"&view=ungraded",jQuery.post(ajaxurl,{action:"get_redirect_url",get_lessons_html_nonce:woo_localized_data.get_lessons_html_nonce,data:t},function(e){""!=e&&(window.location=e)}),!1}),jQuery(".grading-mark").on("change","input",function(){"right"==this.value?(jQuery("#"+this.name+"_box").addClass("user_right").removeClass("user_wrong"),jQuery("#"+this.name+"_box").find("input.question-grade").val(jQuery("#"+this.name+"_box").find("input.question_total_grade").val())):(jQuery("#"+this.name+"_box").addClass("user_wrong").removeClass("user_right"),jQuery("#"+this.name+"_box").find("input.question-grade").val(0)),jQuery.fn.calculateTotalGrade()}),jQuery(".question-grade").on("change","",function(){var e=parseInt(jQuery(this).val()),r=this.id.replace("_grade","");e>0?(jQuery("#"+r+"_box").addClass("user_right").removeClass("user_wrong"),jQuery("#"+r+"_box .grading-mark input."+r+"_right_option").attr("checked","checked"),jQuery("#"+r+"_box .grading-mark input."+r+"_wrong_option").attr("checked",!1)):(jQuery("#"+r+"_box").addClass("user_wrong").removeClass("user_right"),jQuery("#"+r+"_box .grading-mark input."+r+"_wrong_option").attr("checked","checked"),jQuery("#"+r+"_box .grading-mark input."+r+"_right_option").attr("checked",!1)),jQuery.fn.calculateTotalGrade()}),jQuery(".sensei-grading-main .buttons").on("click",".reset-button",function(){jQuery.fn.resetGrades()}),jQuery(".sensei-grading-main .buttons").on("click",".autograde-button",function(){jQuery.fn.autoGrade()}),jQuery("#grading-course-options").exists()&&jQuery("#grading-course-options").select2(),jQuery("#grading-lesson-options").exists()&&jQuery("#grading-lesson-options").select2()});